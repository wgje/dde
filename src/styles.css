@tailwind base;
@tailwind components;
@tailwind utilities;

/* å…¨å±€å­—ä½“è®¾ç½® - å¼ºåˆ¶ä½¿ç”¨éœé¹œæ–‡æ¥·å±å¹•é˜…è¯»ç‰ˆ */
*, *::before, *::after,
input, button, select, textarea {
  font-family: "LXGW WenKai Screen", sans-serif !important;
}

body {
  font-family: "LXGW WenKai Screen", sans-serif;
}

/* ========== ä¸»é¢˜å˜é‡ ========== */
:root {
  /* é»˜è®¤ä¸»é¢˜ - åŸçŸ³è‰²ç³» */
  --theme-bg: #F9F8F6;
  --theme-sidebar-bg: #F9F8F6;
  --theme-card-bg: #FFFFFF;
  --theme-primary: #4f46e5;
  --theme-primary-light: #eef2ff;
  --theme-accent: #0d9488;
  --theme-text: #57534e;
  --theme-text-dark: #292524;
  --theme-border: #e7e5e4;
}

/* æµ·æ´‹ä¸»é¢˜ */
[data-theme="ocean"] {
  --theme-bg: #f0f9ff;
  --theme-sidebar-bg: #e0f2fe;
  --theme-card-bg: #ffffff;
  --theme-primary: #0284c7;
  --theme-primary-light: #e0f2fe;
  --theme-accent: #0891b2;
  --theme-text: #475569;
  --theme-text-dark: #0c4a6e;
  --theme-border: #bae6fd;
}

/* æ£®æ—ä¸»é¢˜ */
[data-theme="forest"] {
  --theme-bg: #f0fdf4;
  --theme-sidebar-bg: #dcfce7;
  --theme-card-bg: #ffffff;
  --theme-primary: #16a34a;
  --theme-primary-light: #dcfce7;
  --theme-accent: #059669;
  --theme-text: #4b5563;
  --theme-text-dark: #14532d;
  --theme-border: #bbf7d0;
}

/* æ—¥è½ä¸»é¢˜ */
[data-theme="sunset"] {
  --theme-bg: #fff7ed;
  --theme-sidebar-bg: #ffedd5;
  --theme-card-bg: #ffffff;
  --theme-primary: #ea580c;
  --theme-primary-light: #ffedd5;
  --theme-accent: #dc2626;
  --theme-text: #57534e;
  --theme-text-dark: #7c2d12;
  --theme-border: #fed7aa;
}

/* è–°è¡£è‰ä¸»é¢˜ */
[data-theme="lavender"] {
  --theme-bg: #faf5ff;
  --theme-sidebar-bg: #f3e8ff;
  --theme-card-bg: #ffffff;
  --theme-primary: #9333ea;
  --theme-primary-light: #f3e8ff;
  --theme-accent: #c026d3;
  --theme-text: #6b7280;
  --theme-text-dark: #581c87;
  --theme-border: #e9d5ff;
}

/* åº”ç”¨ä¸»é¢˜å˜é‡ */
.theme-bg { background-color: var(--theme-bg); }
.theme-sidebar-bg { background-color: var(--theme-sidebar-bg); }
.theme-card-bg { background-color: var(--theme-card-bg); }
.theme-primary { color: var(--theme-primary); }
.theme-primary-bg { background-color: var(--theme-primary); }
.theme-primary-light-bg { background-color: var(--theme-primary-light); }
.theme-accent { color: var(--theme-accent); }
.theme-text { color: var(--theme-text); }
.theme-text-dark { color: var(--theme-text-dark); }
.theme-border { border-color: var(--theme-border); }

/* å¼¹çª—åŠ¨ç”» */
.animate-fade-in {
  animation: fadeIn 0.2s ease-out;
}
.animate-scale-in {
  animation: scaleIn 0.2s ease-out;
}
.animate-slide-up {
  animation: slideUp 0.25s ease-out;
}
.animate-dropdown {
  animation: dropdown 0.15s ease-out;
}
.animate-slide-down {
  animation: slideDown 0.2s ease-out;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
@keyframes scaleIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}
@keyframes slideUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes dropdown {
  from { opacity: 0; transform: translateY(-8px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes slideDown {
  from { opacity: 0; transform: translateY(-8px); }
  to { opacity: 1; transform: translateY(0); }
}

/* å±•å¼€æ”¶èµ·åŠ¨ç”» - æ— æŠ–åŠ¨ç‰ˆæœ¬ */
.animate-collapse-open {
  animation: collapseOpen 0.15s ease-out;
}

@keyframes collapseOpen {
  from { 
    opacity: 0;
    transform: translateY(-4px);
  }
  to { 
    opacity: 1;
    transform: translateY(0);
  }
}

/* Mobile-friendly tweaks */
.responsive-stack {
  display: flex;
  flex-direction: row;
}

@media (max-width: 768px) {
  .responsive-stack {
    flex-direction: column;
  }

  /* åªå¯¹ä¸»è¦äº¤äº’å…ƒç´ åº”ç”¨ 44px æœ€å°é«˜åº¦ï¼Œæ’é™¤ç´§å‡‘æŒ‰é’® */
  input,
  select,
  textarea,
  .touch-target {
    min-height: 44px;
    padding-top: 0.5rem;
    padding-bottom: 0.5rem;
  }
  
  /* ç´§å‡‘æŒ‰é’®ï¼šä¸å¼ºåˆ¶æœ€å°é«˜åº¦ */
  .btn-compact {
    min-height: auto !important;
    padding-top: 0.25rem !important;
    padding-bottom: 0.25rem !important;
  }
}

/* è§¦æ‘¸è®¾å¤‡ï¼šç¦ç”¨ hover çŠ¶æ€çš„ç²˜æ»æ•ˆæœ */
@media (hover: none) and (pointer: coarse) {
  /* é˜²æ­¢ hover çŠ¶æ€åœ¨è§¦æ‘¸å"ç²˜ä½" */
  .group:hover .group-hover\:text-stone-500,
  .group:hover .group-hover\:text-stone-900,
  .group:hover .group-hover\:bg-stone-400,
  .group:hover .group-hover\:text-retro-rust,
  .group:hover .group-hover\:bg-orange-400 {
    color: inherit;
    background-color: inherit;
  }
  
  /* è§¦æ‘¸è®¾å¤‡ä¸Šè®©æŸäº›éšè—å…ƒç´ å§‹ç»ˆå¯è§ */
  .touch-always-visible {
    opacity: 1 !important;
    visibility: visible !important;
  }
  
  /* å¢åŠ è§¦æ‘¸è®¾å¤‡ä¸Šçš„ç‚¹å‡»åé¦ˆ */
  button:active,
  .cursor-pointer:active {
    transform: scale(0.97);
    transition: transform 0.1s ease;
  }
}

/* GoJS è¯•ç”¨ç‰ˆæ°´å°éšè— */
/* ğŸ”§ ä¿®å¤ï¼šæ›´ç²¾ç¡®çš„é€‰æ‹©å™¨ï¼Œé¿å…æ„å¤–éšè—å…¶ä»– pointer-events: none çš„å…ƒç´  */
.flow-canvas-container canvas + div[style*="pointer-events"],
div[class*="diagram"] > div:last-child:not(:first-child):not([data-drag-ghost]) {
  opacity: 0 !important;
  pointer-events: none !important;
}

/* ç§»åŠ¨ç«¯æ»šåŠ¨ä¼˜åŒ– */
.mobile-scroll {
  -webkit-overflow-scrolling: touch;
  touch-action: pan-y;
  transform: translateZ(0);
  backface-visibility: hidden;
}

/* ç§»åŠ¨ç«¯æŠ½å±‰æ»šåŠ¨åŒºåŸŸä¼˜åŒ– */
@media (max-width: 768px) {
  .overflow-y-auto {
    -webkit-overflow-scrolling: touch;
    scroll-behavior: auto;
  }
  
  /* æ–‡æœ¬è§†å›¾å®¹å™¨ - å…è®¸æ°´å¹³æ»‘åŠ¨æ‰‹åŠ¿ç©¿é€ */
  .text-view-scroll-container {
    touch-action: pan-y pan-x;
  }
}

/* Markdown é¢„è§ˆæ ·å¼ */
.markdown-preview {
  line-height: 1.6;
  word-wrap: break-word;
}

.markdown-preview h1 {
  font-size: 1.25em;
  font-weight: 700;
  color: #292524;
  margin: 0.75em 0 0.5em 0;
  padding-bottom: 0.25em;
  border-bottom: 1px solid #e7e5e4;
}

.markdown-preview h2 {
  font-size: 1.125em;
  font-weight: 600;
  color: #292524;
  margin: 0.6em 0 0.4em 0;
}

.markdown-preview h3 {
  font-size: 1em;
  font-weight: 600;
  color: #44403c;
  margin: 0.5em 0 0.3em 0;
}

.markdown-preview h4,
.markdown-preview h5,
.markdown-preview h6 {
  font-size: 0.875em;
  font-weight: 600;
  color: #57534e;
  margin: 0.4em 0 0.25em 0;
}

.markdown-preview p {
  margin: 0.5em 0;
  color: #57534e;
}

.markdown-preview strong {
  font-weight: 600;
  color: #292524;
}

.markdown-preview em {
  font-style: italic;
}

.markdown-preview code {
  background-color: #f5f5f4;
  color: #dc2626;
  padding: 0.125em 0.375em;
  border-radius: 0.25em;
  font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, monospace;
  font-size: 0.875em;
}

.markdown-preview pre {
  background-color: #1c1917;
  color: #e7e5e4;
  padding: 0.75em 1em;
  border-radius: 0.5em;
  overflow-x: auto;
  margin: 0.5em 0;
  font-size: 0.8em;
}

.markdown-preview pre code {
  background: none;
  color: inherit;
  padding: 0;
  font-size: inherit;
}

.markdown-preview blockquote {
  border-left: 3px solid #a8a29e;
  padding-left: 1em;
  margin: 0.5em 0;
  color: #78716c;
  font-style: italic;
}

.markdown-preview ul,
.markdown-preview ol {
  margin: 0.5em 0;
  padding-left: 1.5em;
}

.markdown-preview ul {
  list-style-type: disc;
}

.markdown-preview ol {
  list-style-type: decimal;
}

.markdown-preview li {
  margin: 0.25em 0;
  color: #57534e;
}

.markdown-preview a {
  color: #4f46e5;
  text-decoration: underline;
  transition: color 0.15s;
}

.markdown-preview a:hover {
  color: #3730a3;
}

.markdown-preview hr {
  border: none;
  border-top: 1px solid #d6d3d1;
  margin: 1em 0;
}

/* Markdown todo é¡¹æ ·å¼ */
.markdown-preview input[type="checkbox"] {
  margin-right: 0.5em;
  accent-color: #4f46e5;
}

/* ========== GoJS æµç¨‹å›¾ç”»å¸ƒè§¦æ‘¸æ‰‹åŠ¿ ========== */
/* æ˜¾å¼ç¦ç”¨æµè§ˆå™¨é»˜è®¤çš„è§¦æ‘¸æ‰‹åŠ¿ï¼Œé¿å…ä¸ GoJS ç”»å¸ƒæ“ä½œå†²çª */
.flow-canvas-container {
  touch-action: none;
  /* é˜²æ­¢é•¿æŒ‰è§¦å‘ä¸Šä¸‹æ–‡èœå• */
  -webkit-touch-callout: none;
  /* é˜²æ­¢æ–‡æœ¬é€‰æ‹© */
  -webkit-user-select: none;
  user-select: none;
}

/* ========== æ‹–æ‹½å¹½çµå…ƒç´ æ ·å¼ ========== */
/* å¼ºåˆ¶ä½¿ data-drag-ghost å…ƒç´ å¯è§ï¼Œè¦†ç›–ä»»ä½•å¯èƒ½çš„éšè—è§„åˆ™ */
[data-drag-ghost="true"] {
  position: fixed !important;
  z-index: 2147483647 !important;
  visibility: visible !important;
  opacity: 1 !important;
  display: flex !important;
  pointer-events: none !important;
}

/* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
.custom-scrollbar::-webkit-scrollbar {
  width: 5px;
}

.custom-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
  background: #e2e8f0;
  border-radius: 10px;
}

.custom-scrollbar::-webkit-scrollbar-thumb:hover {
  background: #cbd5e1;
}
